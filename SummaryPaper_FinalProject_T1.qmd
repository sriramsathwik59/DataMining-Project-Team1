---
title: "ELECTRIC VEHICLES ADOPTION ANALYSIS IN AMERICA ACROSS DIFFERENT REGIONS"
author: "TEAM 1: SriramSathwik Tippavaram, Hrushikesh Sai Seshagiri Chowdary Uppalapati, Jagadeshwar Kalyanapu"
date: "December 19, 2023"
subtitle: "DATS 6103: An Introduction to Data Mining"
format:
  html:
    theme: united
    highlight-style: monochrome 
    smooth-scroll: true
    toc-location: left
    code-fold: true
    number-sections: true
    toc: true
    toc-depth: 3
    toc-float: true
jupyter: python3
---



# ABSTRACT

This study delves into the dynamics of electric vehicle (EV) adoption across different regions in the United States, highlighting regional disparities and EV growth trends. The study investigates factors influencing adoption rates, such as state policies, economic incentives, and infrastructure development, using a large dataset. The goal is to identify patterns and potential areas for policy intervention by better understanding the impact of regional characteristics on EV popularity. This analysis is critical for automotive industry stakeholders, policymakers, and environmental advocates, as it provides insight into the future trajectory of sustainable transportation in America.


# Introduction

The transition to electric vehicles (EVs) is a critical component of the global transition to sustainability, particularly in the context of the United States, where transportation contributes significantly to carbon emissions. The purpose of this study is to dissect the complexities of EV adoption across various American regions, highlighting the disparities and underlying factors that influence this trend. The study's foundation is a large dataset that reflects the multifaceted nature of EV proliferation, including variables like vehicle types, regional distributions, and chronological adoption trends. 

The dataset's richness allows for in-depth exploration of state-by-state vehicle counts, county-level data, and vehicle primary use categories. This study not only highlights the current state of EV adoption, but also delves into the economic, policy-driven, and infrastructure factors driving this movement. This type of analysis is critical for policymakers, industry stakeholders, and environmentalists because it provides actionable insights to encourage EV integration.

In essence, this study not only maps the current landscape of EV adoption in the United States, but it also serves as a strategic guide for navigating the challenges and capitalising on the opportunities in this domain. It exemplifies the potential of sustainable transport and the critical role of informed decision-making in meeting environmental targets.

# Summary of the Dataset

This study's dataset includes extensive records of electric vehicle (EV) adoption across the United States. It contains information such as vehicle counts, types (BEVs and PHEVs), regional distribution, and year-to-year trends. The dataset also includes demographic and geographic information, allowing for a thorough examination of regional disparities in EV adoption. Critical features like state-by-state vehicle totals, county-level data, and primary use categories provide a comprehensive picture of the EV landscape. This rich dataset serves as the foundation for our analysis, allowing for a more nuanced understanding of the factors driving EV adoption across America.

# The SMART Questions

This study is organised around five critical SMART questions in order to gain a comprehensive understanding of the dynamics surrounding electric vehicle adoption in the United States. These questions have been carefully crafted to be specific, measurable, achievable, relevant, and time-bound in order to provide targeted insights and tangible results.

1) How is the EV trend across years in different regions?

2) Is there a statistically significant association between geographic regions and the primary use categories of electric vehicles?

3) Can demographic and regional factors, such as year, state, and region, effectively predict the likelihood of a county having high electric vehicle adoption rates?

4) Is there a significant difference in the average number of electric vehicles (EVs) between the top 5 counties of the South region and the top 5 counties of the Northeast region in the United States?

5) Is there a relationship between the year and total vehicle count in predicting regional EV adoption?


# LIBRARIES 
```{python}
#| code-fold: true
#| code-summary: "Show the code"
#| warning: false

import warnings
warnings.filterwarnings("ignore")
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from  scipy.stats import ttest_ind
import statsmodels.api as sm
import pandas as pd
from sklearn.linear_model import LogisticRegression
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import accuracy_score, classification_report
from scipy.stats import f_oneway
import pandas as pd
from scipy.stats import chi2_contingency
import matplotlib.patches as mpatches

```

## Importing Dataset

```{python}
#| code-fold: true
#| code-summary: "Show the code"
#| warning: false

warnings.filterwarnings("ignore")
file_path = 'EV_POPULATION_DATASET.csv'
ev_data = pd.read_csv(file_path)
print(ev_data.head())

```
## Data Cleaning
```{python}
#| code-fold: true
#| code-summary: "Show the code"
#| warning: false

import warnings
warnings.filterwarnings("ignore")
# Checking for null values in the dataset
null_values = ev_data.isnull().sum()
print(null_values)


```
```{python}
#| code-fold: true
#| code-summary: "Show the code"
#| warning: false
ev_data_cleaned = ev_data.dropna()

# Displaying the first few rows of the cleaned DataFrame
print(len(ev_data_cleaned))
```

**Observation:** The "County" and "State" columns each have 81 missing values. There are no missing values in the remaining columns, which include various metrics related to electric vehicles. Addressing missing values in "County" and "State" may be required for a thorough analysis.


## Data Pre-processing


```{python}
#| code-fold: true
#| code-summary: "Show the code"
#| warning: false

import warnings
warnings.filterwarnings("ignore")
#divide sates based on region
state_region_map = {
    'WA': 'West', 'OR': 'West', 'CA': 'West', 'AK': 'West', 'HI': 'West', 'NV': 'West', 'ID': 'West',
    'MT': 'West', 'WY': 'West', 'UT': 'West', 'AZ': 'West', 'CO': 'West', 'NM': 'West',
    'ND': 'Midwest', 'SD': 'Midwest', 'NE': 'Midwest', 'KS': 'Midwest', 'MN': 'Midwest', 'IA': 'Midwest', 'MO': 'Midwest',
    'WI': 'Midwest', 'IL': 'Midwest', 'MI': 'Midwest', 'IN': 'Midwest', 'OH': 'Midwest',
    'PA': 'Northeast', 'NY': 'Northeast', 'VT': 'Northeast', 'NH': 'Northeast', 'ME': 'Northeast', 'MA': 'Northeast',
    'RI': 'Northeast', 'CT': 'Northeast', 'NJ': 'Northeast', 'DE': 'Northeast', 'MD': 'Northeast',
    'WV': 'South', 'VA': 'South', 'KY': 'South', 'TN': 'South', 'NC': 'South', 'SC': 'South', 'GA': 'South',
    'FL': 'South', 'AL': 'South', 'MS': 'South', 'AR': 'South', 'LA': 'South', 'TX': 'South', 'OK': 'South'
}
ev_data_cleaned['Region'] = ev_data_cleaned['State'].map(state_region_map)
print(ev_data_cleaned.head())

```
```{python}
#| code-fold: true
#| code-summary: "Show the code"
#| warning: false

import warnings
warnings.filterwarnings("ignore")
ev_data_cleaned.rename(columns={'Date': 'Year'}, inplace=True)
```
```{python}
#| code-fold: true
#| code-summary: "Show the code"
#| warning: false

import warnings
warnings.filterwarnings("ignore")
#Converting Date column
# Preprocess the 'Date' column by converting it to datetime format
ev_data_cleaned['Year'] = pd.to_datetime(ev_data_cleaned['Year'], errors='coerce')
# Replace the 'Date' column with just the year component
ev_data_cleaned['Year'] = ev_data_cleaned['Year'].dt.year.astype('Int64')  # Using 'Int64' to handle NaT (missing dates) properly

print(ev_data_cleaned.head())

```

**Observation:** Based on the all the pre-processing steps above, several critical steps are taken in the provided data pre-processing code to prepare the dataset for analysis. To begin, the dataset is divided into regions based on the states, and for this we have used dictionaries to map unique states based on the regions. The 'Date' column is then renamed 'Year' for clarity. Finally, the 'Year' column is converted to a datetime format and refined further to extract the year component, resulting in consistent and accurate date data for analysis. These steps improve data clarity and allow for more meaningful insights into electric vehicle trends over time.

```{python}
#| code-fold: true
#| code-summary: "Show the code"
#| warning: false

import warnings
warnings.filterwarnings("ignore")
output_file_path = 'dataset_new.csv'
ev_data_cleaned.to_csv(output_file_path, index=False)
df=pd.read_csv('dataset_new.csv')


```

**Observation:**
Many columns are in object type datatypes, but we want to convert them to categorical variables.

Object to categorical variable conversion


# EXPLORATORY DATA ANALYSIS 
```{python}
#| code-fold: true
#| code-summary: "Show the code"
#| warning: false

import warnings
warnings.filterwarnings("ignore")
# Setting the aesthetics for the plots
sns.set(style="whitegrid")

# Visualization 1: Trend of Electric Vehicle Adoption Over Time
plt.figure(figsize=(12, 6))
df.groupby('Year')['Electric Vehicle (EV) Total'].sum().plot(kind='line', marker='o')
plt.title('Trend of Electric Vehicle Adoption Over Time')
plt.xlabel('Year')
plt.ylabel('Total Number of Electric Vehicles')
plt.xticks(rotation=45)
plt.tight_layout()
plt.show()

# Visualization 2: Regional Distribution of Electric Vehicles
plt.figure(figsize=(10, 6))
sns.barplot(x='Region', y='Electric Vehicle (EV) Total', data=df, estimator=sum, ci=None)
plt.title('Regional Distribution of Electric Vehicles')
plt.xlabel('Region')
plt.ylabel('Total Number of Electric Vehicles')
plt.tight_layout()

plt.show()

```


**Observation:**
**Trend of Electric Vehicle Adoption Over Time:** From 2017 to 2021, the line chart shows a consistent upward trajectory in electric vehicle adoption, indicating robust growth. The drop in 2023 suggests a possible market contraction or reporting anomaly that should be investigated further.

**Regional Distribution of Electric Vehicles:** This bar chart shows a significant regional variation in EV adoption, with the West far ahead. It emphasises the uneven adoption of electric vehicles, pointing to regional preferences or disparities in infrastructure and policy support.
 
## SMART Question 1:How is the EV trend across years in different regions?

```{python}
#| code-fold: true
#| code-summary: "Show the code"
#| warning: false

import warnings
warnings.filterwarnings("ignore")
# Visualization: Trend of Electric Vehicles Over the Years by Region
plt.figure(figsize=(14, 7))
sns.lineplot(data=df, x='Year', y='Electric Vehicle (EV) Total', hue='Region', marker='o')
plt.title('Trend of Electric Vehicles Over the Years by Region')
plt.xlabel('Year')
plt.ylabel('Total Electric Vehicles')
plt.legend(title='Region', loc='upper left')
plt.grid(True)
plt.show()

```
**Conclusion for the SMART Q1:** 
The multi-line chart with confidence intervals demonstrates that, while all regions are experiencing growth in EV adoption, the West region's pace is noticeably faster. The graph also suggests that regional disparities in EV adoption rates are increasing over time.


## Checking the EV adoption in the top5 counties from each region
```{python}
#| code-fold: true
#| code-summary: "Show the code"
#| warning: false

import warnings
warnings.filterwarnings("ignore")
def plot_top_5_counties_for_region(dataframe, region_name):
    # Filter for the current region
    region_df = dataframe[dataframe['Region'] == region_name]

    # Group by 'County' and sum up the EV totals
    ev_totals = region_df.groupby('County')['Electric Vehicle (EV) Total'].sum()

    # Sort and get the top 5 counties
    top_5_counties = ev_totals.nlargest(5)

    # Create the bar chart
    sns.barplot(x=top_5_counties.index, y=top_5_counties.values, palette='viridis')
    plt.title(f'Top 5 Counties in EV Adoption in {region_name} Region')
    plt.xlabel('County')
    plt.ylabel('Total EVs')
    plt.xticks(rotation=45)

# Plot for a single region as an example
plt.figure(figsize=(12, 6))
plot_top_5_counties_for_region(df, 'South')
plt.show()

```
**Observation:** 
The bar chart indicates Fairfax County leads in EV adoption within the South region, followed by Bexar and others. This may reflect differing economic dynamics, policy incentives, or consumer behaviors at the county level within the region.


```{python}
#| code-fold: true
#| code-summary: "Show the code"
#| warning: false

import warnings
warnings.filterwarnings("ignore")
plt.figure(figsize=(12, 6))
plot_top_5_counties_for_region(df, 'Midwest')
plt.show()

```
**Observation:** 
The top counties in the Midwest region have a more even distribution of EV adoption. Hennepin and Page counties lead, with Douglas close behind, indicating a more homogeneous adoption pattern among the top performers in this region.


```{python}
#| code-fold: true
#| code-summary: "Show the code"
#| warning: false

import warnings
warnings.filterwarnings("ignore")
plt.figure(figsize=(12, 6))
plot_top_5_counties_for_region(df, 'West')
plt.show()

```
**Observation:**
San Diego leads the West in EV adoption, with significant contributions from Los Angeles and Santa Clara. The chart indicates that California's urban counties have a high concentration of EVs, most likely due to favourable policies and infrastructure.

# EDA of BEV AND PHEV's

```{python}
#| code-fold: true
#| code-summary: "Show the code"
#| warning: false

import warnings
warnings.filterwarnings("ignore")
# Grouping the data by state and summing up the BEVs and PHEVs
state_ev_totals = df.groupby('State')[['Battery Electric Vehicles (BEVs)', 'Plug-In Hybrid Electric Vehicles (PHEVs)']].sum()

# Sorting the states based on the total number of EVs (BEVs + PHEVs)
state_ev_totals['Total EVs'] = state_ev_totals['Battery Electric Vehicles (BEVs)'] + state_ev_totals['Plug-In Hybrid Electric Vehicles (PHEVs)']
state_ev_totals_sorted = state_ev_totals.sort_values(by='Total EVs', ascending=False)

# Plotting a stacked bar chart
state_ev_totals_sorted[['Battery Electric Vehicles (BEVs)', 'Plug-In Hybrid Electric Vehicles (PHEVs)']].plot(kind='bar', stacked=True, figsize=(15, 8))
plt.title('Adoption of BEVs and PHEVs by State')
plt.xlabel('State')
plt.ylabel('Number of Electric Vehicles')
plt.legend(title='Vehicle Type')
plt.tight_layout()

# Display the plot
plt.show()

```
**Observation:** 
When compared to other states, California has a significant lead in the adoption of both BEVs and PHEVs, reflecting its pioneering role in EV adoption. This stacked bar chart highlights the state's dominance in the EV market.


```{python}
#| code-fold: true
#| code-summary: "Show the code"
#| warning: false

import warnings
warnings.filterwarnings("ignore")
# Bar Chart of Average EVs by State
average_evs_by_state = df.groupby('State')['Electric Vehicle (EV) Total'].mean().sort_values(ascending=False)

plt.figure(figsize=(15, 8))
average_evs_by_state.plot(kind='bar', color='skyblue')
plt.title('Average Number of EVs by State')
plt.xlabel('State')
plt.ylabel('Average Number of EVs')
plt.xticks(rotation=45)
plt.show()

```
**Observation:** 
Arizona leads the way in average EVs per state, indicating high adoption rates, which could be attributed to favourable incentives or infrastructure. The descending order contrasts sharply with states at the opposite end of the spectrum, where adoption is clearly lower.




